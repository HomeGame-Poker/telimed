{"version":3,"sources":["Shared.js","LocalTracks.js","LocalSpeaker.js","RemoteTrack.js","App.js","index.js"],"names":["componentGetCompareProps","path","current","previous","defaultValue","transfrom","cur","_","get","pre","isFunction","Current","Previous","HasChanged","LocalTracks","props","onTrackStoppedEvent","event","console","log","onTrackAudioOutputChangedEvent","deviceId","updateLocalTrack","action","clearTrack","find","trackList","getType","micRef","detach","removeEventListener","window","JitsiMeetJS","events","track","LOCAL_TRACK_STOPPED","TRACK_AUDIO_OUTPUT_CHANGED","dispose","videoRef","setTrack","t","attach","addEventListener","mute","onCameraChange","setState","selectedVideoDeviceId","target","value","onMicrophoneChange","selectedMicDeviceId","state","loaded","React","createRef","this","deviceList","defaultMicId","defaultVideoId","activeRoomId","createLocalTracks","devices","then","tracks","deviceIds","map","nd","id","indexOf","push","telimed","activeRoom","videoTrack","micTrack","addTrack","prevProps","prevState","class","onChange","concat","name","type","filter","d","autoPlay","ref","Component","LocalSpeaker","onSpeakerChanged","speakerList","newSpeakerId","selectedSpeakerDeviceId","defaultSpeakerId","firstSpeaker","Fragment","s","RemoteTrack","updateTrack","selectedVideoId","selectedMicId","trackIds","remoteTracks","rt","newState","setAudioOutput","ct","join","pt","participantId","first","tid","oldVideoTrack","oldMicTrack","error","message","App","newSpeaker","onServerChanged","serverURL","onRoomChanged","roomId","onRoomTrackAdded","isLocal","newTrackId","getId","trackInfo","getParticipantId","remoteTrackIds","onRoomTrackRemoved","trackId","reject","onConnectionSuccess","activeConnection","initJitsiConference","openBridgeChannel","conference","TRACK_ADDED","TRACK_REMOVED","status","lastError","uuidv4","onConnectionFailed","a","b","c","onConnectionDisconnect","connection","CONNECTION_ESTABLISHED","CONNECTION_FAILED","CONNECTION_DISCONNECTED","onConnect","JitsiConnection","hosts","domain","muc","serviceUrl","clientNode","connect","onDisconnect","leave","disconnect","renderRemoteTracks","trackGroups","ret","participantIds","keys","length","key","className","mediaDevices","enumerateDevices","newDeviceList","device","label","kind","micId","videoId","speakerId","remoteTrackGroups","groupBy","readOnly","onClick","disabled","init","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.ef7901ea.chunk.js","sourcesContent":["import _ from 'lodash'\r\n\r\nexport const componentGetCompareProps = (path, current, previous, defaultValue, transfrom) => {\r\n    let cur = _.get(current, path, defaultValue)\r\n    let pre = _.get(previous, path, defaultValue)\r\n  \r\n    if (_.isFunction(transfrom)) {\r\n      cur = transfrom(_, cur)\r\n      pre = transfrom(_, pre)\r\n    }\r\n  \r\n    return {\r\n      Current: cur,\r\n      Previous: pre,\r\n      HasChanged: cur !== pre\r\n    }\r\n  }","import React from 'react';\r\nimport _ from 'lodash'\r\nimport { componentGetCompareProps } from './Shared'\r\nimport './LocalTracks.css'\r\n\r\nexport class LocalTracks extends React.Component {\r\n    constructor (props) {\r\n        super(props)\r\n\r\n        this.state = {\r\n            selectedMicDeviceId: 'none',\r\n            selectedVideoDeviceId: 'none',\r\n            loaded: false\r\n        }\r\n        this.videoRef = React.createRef()\r\n        this.micRef = React.createRef()\r\n        this.trackList = []\r\n    }\r\n\r\n    componentDidMount () {\r\n        const { deviceList = [], defaultMicId, defaultVideoId, activeRoomId } = this.props\r\n\r\n        window.JitsiMeetJS.createLocalTracks({ devices: ['audio', 'video']})\r\n        .then((tracks) => {\r\n            let deviceIds = _.map(deviceList, (nd) => nd.id)\r\n            for (let track of tracks) {\r\n                if (_.indexOf(deviceIds, track.deviceId) !== -1) {\r\n                    this.trackList.push(track)\r\n                }\r\n            }\r\n            this.setState({\r\n                loaded: true,\r\n                deviceList: deviceList,\r\n                selectedMicDeviceId: defaultMicId,\r\n                selectedVideoDeviceId: defaultVideoId,\r\n            }, () => {\r\n                this.updateLocalTrack(defaultMicId, 'set')\r\n                this.updateLocalTrack(defaultVideoId, 'set')\r\n\r\n                if (activeRoomId && window.telimed.activeRoom) {\r\n                    let videoTrack = _.find(this.trackList, (t) => { return t.deviceId === defaultVideoId })\r\n                    let micTrack = _.find(this.trackList, (t) => { return t.deviceId === defaultMicId })   \r\n                    if (videoTrack) {\r\n                        window.telimed.activeRoom.addTrack(videoTrack)\r\n                    }\r\n                    if (micTrack) {\r\n                        window.telimed.activeRoom.addTrack(micTrack)\r\n                    }\r\n                }\r\n            })\r\n        })\r\n    }\r\n\r\n    onTrackStoppedEvent = (event) => {\r\n        console.log(`Track Stopped`)\r\n    }\r\n\r\n    onTrackAudioOutputChangedEvent = (deviceId) => {\r\n        console.log(`Track ${deviceId} audio output changed`)\r\n    }\r\n\r\n    updateLocalTrack = (deviceId, action = 'clear') => {\r\n        if (action === 'clear') {\r\n            let clearTrack = _.find(this.trackList, { deviceId: deviceId })\r\n            if (clearTrack) {\r\n                // eslint-disable-next-line default-case\r\n                switch (clearTrack.getType()) {\r\n                    case 'audio':\r\n                    if (this.micRef.current) {\r\n                        clearTrack.detach(this.micRef.current)\r\n                        clearTrack.removeEventListener(window.JitsiMeetJS.events.track.LOCAL_TRACK_STOPPED, this.onTrackStoppedEvent);\r\n                        clearTrack.removeEventListener(window.JitsiMeetJS.events.track.TRACK_AUDIO_OUTPUT_CHANGED, this.onTrackAudioOutputChangedEvent);\r\n                        clearTrack.dispose()\r\n                    }\r\n                    break\r\n                    case 'video':\r\n                        if (this.videoRef.current) {\r\n                            clearTrack.detach(this.videoRef.current)\r\n                            clearTrack.dispose()\r\n                        }\r\n                    break\r\n                }\r\n            }\r\n        } else if (action === 'set') {\r\n            let setTrack = _.find(this.trackList, (t) => { return t.deviceId === deviceId })\r\n            if (setTrack) {\r\n            // eslint-disable-next-line default-case\r\n                switch (setTrack.getType()) {\r\n                    case 'audio':\r\n                        if (this.micRef.current) {\r\n                            setTrack.attach(this.micRef.current)\r\n                            setTrack.addEventListener(window.JitsiMeetJS.events.track.LOCAL_TRACK_STOPPED, this.onTrackStoppedEvent);\r\n                            setTrack.addEventListener(window.JitsiMeetJS.events.track.TRACK_AUDIO_OUTPUT_CHANGED, this.onTrackAudioOutputChangedEvent);\r\n                            setTrack.mute()\r\n                        }\r\n                    break\r\n                    case 'video':\r\n                        if (setTrack && this.videoRef.current) {\r\n                            setTrack.attach(this.videoRef.current)\r\n                        }\r\n                    break\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    componentDidUpdate (prevProps, prevState) {\r\n        \r\n        const selectedVideoDeviceId = componentGetCompareProps('selectedVideoDeviceId', this.state, prevState, '')\r\n\r\n        if (selectedVideoDeviceId.HasChanged) {\r\n            if (selectedVideoDeviceId.Previous !== '') {\r\n                this.updateLocalTrack(selectedVideoDeviceId.Previous, 'clear')\r\n            }\r\n            if (selectedVideoDeviceId.Current !== '') {\r\n                this.updateLocalTrack(selectedVideoDeviceId.Current, 'set' )\r\n            }\r\n        }\r\n\r\n        const selectedMicDeviceId = componentGetCompareProps('selectedMicDeviceId', this.state, prevState, '')\r\n\r\n        if (selectedMicDeviceId.HasChanged) {\r\n            if (selectedMicDeviceId.Previous !== '') {\r\n                this.updateLocalTrack(selectedMicDeviceId.Previous, 'clear')\r\n            }\r\n            if (selectedMicDeviceId.Current !== '') {\r\n                this.updateLocalTrack(selectedMicDeviceId.Current, 'set' )\r\n            }\r\n        }\r\n\r\n        const activeRoomId = componentGetCompareProps('activeRoomId', this.props, prevProps, '')\r\n\r\n        if (activeRoomId.HasChanged) {\r\n            if (activeRoomId.Current && window.telimed.activeRoom) {\r\n                const { selectedMicDeviceId, selectedVideoDeviceId } = this.state\r\n                let videoTrack = _.find(this.trackList, (t) => { return t.deviceId === selectedVideoDeviceId })\r\n                let micTrack = _.find(this.trackList, (t) => { return t.deviceId === selectedMicDeviceId })   \r\n                if (videoTrack) {\r\n                    window.telimed.activeRoom.addTrack(videoTrack)\r\n                }\r\n                if (micTrack) {\r\n                    window.telimed.activeRoom.addTrack(micTrack)\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    componentWillUnmount () {\r\n        const { selectedMicDeviceId, selectedVideoDeviceId } = this.state\r\n\r\n        this.updateLocalTrack(selectedMicDeviceId, 'clear')\r\n        this.updateLocalTrack(selectedVideoDeviceId, 'clear')\r\n    }\r\n\r\n    onCameraChange = (event) => {\r\n        this.setState({selectedVideoDeviceId: event.target.value});\r\n    }\r\n\r\n    onMicrophoneChange = (event) => {\r\n        this.setState({selectedMicDeviceId: event.target.value});\r\n    }\r\n\r\n    render () {\r\n        const { selectedVideoDeviceId, selectedMicDeviceId, deviceList = [] } = this.state\r\n        \r\n       \r\n        return <div class='local_track'>\r\n            <div class='local_track_controls'>\r\n                <span>Camera</span>\r\n                <select value={selectedVideoDeviceId} onChange={this.onCameraChange}>\r\n                    {_.map(_.concat([{ name: 'none', id: 'none', type: 'none' }], _.filter(deviceList, { type: 'videoinput' })), (d) => {\r\n                        return <option value={d.id}>{d.name}</option>\r\n                    })}\r\n                </select>\r\n                <span>Microphone</span>\r\n                <select value={selectedMicDeviceId} onChange={this.onMicrophoneChange}>\r\n                    {_.map(_.filter(deviceList, { type: 'audioinput' }), (d) => {\r\n                        return <option value={d.id}>{d.name}</option>\r\n                    })}\r\n                </select>\r\n            </div>\r\n            <div class='local_track_body'>\r\n                <video autoPlay='1' ref={this.videoRef}/>\r\n            </div>\r\n            {/* <div>\r\n                <audio autoPlay='1' muted='true' ref={this.micRef} />\r\n            </div> */}\r\n        </div>\r\n\r\n    }\r\n}","import React from 'react'\r\nimport _ from 'lodash'\r\n\r\nexport class LocalSpeaker extends React.Component {\r\n    constructor (props) {\r\n        super(props)\r\n\r\n        this.state = {\r\n            selectedSpeakerDeviceId: '',\r\n            speakerList: []\r\n        }\r\n    }\r\n\r\n    componentDidMount () {\r\n        const { deviceList = [], defaultSpeakerId, onSpeakerChanged } = this.props\r\n\r\n        this.setState({\r\n            speakerList: _.filter(deviceList, { type: 'audiooutput' }),\r\n            selectedSpeakerDeviceId: defaultSpeakerId\r\n        }, () => {\r\n            if (_.isFunction(onSpeakerChanged)) {\r\n                let firstSpeaker = _.find(deviceList, { id: defaultSpeakerId })\r\n                onSpeakerChanged(firstSpeaker)\r\n            }\r\n        })\r\n    }\r\n\r\n    onSpeakerChanged = (event) => {\r\n        const { onSpeakerChanged } = this.props\r\n        const { speakerList = [] } = this.state\r\n        let newSpeakerId = event.target.value\r\n        this.setState({\r\n            selectedSpeakerDeviceId: newSpeakerId\r\n        }, () => {\r\n            if (_.isFunction(onSpeakerChanged)) {\r\n                onSpeakerChanged(_.find(speakerList, { id: newSpeakerId }) || { id: 'none', name: 'None' })\r\n            }\r\n        })\r\n    }\r\n\r\n    render () {\r\n        const { selectedSpeakerDeviceId, speakerList } = this.state\r\n        return <React.Fragment>\r\n            <span>Speaker</span>\r\n            <select value={selectedSpeakerDeviceId} onChange={this.onSpeakerChanged}>\r\n                {_.map(speakerList, (s) => <option value={s.id}>{s.name}</option>)}\r\n            </select>    \r\n        </React.Fragment>\r\n\r\n    }\r\n\r\n}","import React from 'react';\r\nimport _ from 'lodash'\r\nimport { componentGetCompareProps } from './Shared'\r\nimport './RemoteTrack.css'\r\n\r\nexport class RemoteTrack extends React.Component {\r\n    constructor (props) {\r\n        super(props)\r\n        this.state = {\r\n            selectedVideoId: '',\r\n            selectedMicId: ''\r\n        }\r\n        this.videoRef = React.createRef()\r\n        this.micRef = React.createRef()\r\n        this.tracks = []\r\n    }\r\n\r\n    componentDidMount () {\r\n        const { trackIds = [], selectedSpeakerDeviceId } = this.props\r\n        this.tracks = _.filter(window.telimed.remoteTracks, (rt) => { return _.indexOf(trackIds, rt.id) !== -1 })\r\n\r\n        let videoTrack = _.find(this.tracks, { type: 'video' })\r\n        let micTrack = _.find(this.tracks, { type: 'audio' })\r\n\r\n        if (videoTrack || micTrack) {\r\n            let newState = {}\r\n            if (videoTrack) {\r\n                this.updateTrack(videoTrack, 'set')\r\n                newState.selectedVideoId = videoTrack.id\r\n            }\r\n            if (micTrack) {\r\n                this.updateTrack(micTrack, 'set')\r\n                newState.selectedMicId = micTrack.id\r\n                micTrack.track.setAudioOutput(selectedSpeakerDeviceId)\r\n            }\r\n            this.setState(newState)\r\n        }\r\n    }\r\n\r\n    componentDidUpdate (prevProps) {\r\n\r\n        const trackIds = componentGetCompareProps('trackIds', this.props, prevProps, [])\r\n        const currentTrackIdText = _.map(trackIds.Current, (ct) => { return ct.id }).join(',')\r\n        const previousTrackIdText = _.map(trackIds.Previous, (pt) => { return pt.id}).join(',')\r\n\r\n        if (currentTrackIdText !== previousTrackIdText) {\r\n            let participantId = _.first(_.map(trackIds.Current, (tid) => tid.participantId))\r\n            this.tracks = _.filter(window.telimed.remoteTracks, { participantId: participantId })\r\n            let videoTrack = _.find(this.tracks, { type: 'video' })\r\n            let micTrack = _.find(this.tracks, { type: 'audio' })\r\n            let newState = {}\r\n            if (videoTrack) {\r\n                const { selectedVideoId } = this.state\r\n                if (videoTrack.id !== selectedVideoId) {\r\n                    let oldVideoTrack = _.find(this.tracks, { id: selectedVideoId })\r\n                    if (oldVideoTrack) {\r\n                        this.updateTrack(oldVideoTrack, 'clear')\r\n                    }\r\n                    this.updateTrack(videoTrack, 'set')\r\n                    newState.selectedVideoId = videoTrack.id\r\n                }\r\n            }\r\n            if (micTrack) {\r\n                const { selectedMicId } = this.state\r\n                if (micTrack.id !== selectedMicId) {\r\n                    const { selectedSpeakerDeviceId } = this.props\r\n                    let oldMicTrack = _.find(this.tracks, { id: selectedMicId })\r\n                    if (oldMicTrack) {\r\n                        this.updateTrack(oldMicTrack, 'clear')\r\n                    }\r\n                    this.updateTrack(micTrack, 'set')\r\n                    micTrack.track.setAudioOutput(selectedSpeakerDeviceId)\r\n                    newState.selectedMicId = micTrack.id\r\n                }\r\n            }\r\n            this.setState(newState)\r\n        }\r\n\r\n        const selectedSpeakerDeviceId = componentGetCompareProps('selectedSpeakerDeviceId', this.props, prevProps, '')\r\n\r\n        if (selectedSpeakerDeviceId.HasChanged) {\r\n            const { selectedMicId } = this.state\r\n            let micTrack = _.find(this.tracks, { id: selectedMicId })\r\n            if (micTrack) {\r\n                micTrack.track.setAudioOutput(selectedSpeakerDeviceId.Current)\r\n            }\r\n        }\r\n\r\n    }\r\n\r\n    componentWillUnmount () {\r\n        const { selectedVideoId, selectedMicId } = this.state\r\n        let videoTrack = _.find(this.tracks, { id: selectedVideoId })\r\n        if (videoTrack) {\r\n            try {\r\n                this.updateTrack(videoTrack, 'clear')\r\n            } catch (error) {\r\n                console.log(error.message)\r\n            }\r\n        } \r\n        let micTrack = _.find(this.tracks, { id: selectedMicId }) \r\n        if (micTrack) {\r\n            try {\r\n                this.updateTrack(micTrack, 'clear')\r\n            } catch (error) {\r\n                console.log(error.message)\r\n            }\r\n        }\r\n    }\r\n\r\n    onTrackStoppedEvent = (event) => {\r\n        console.log(`Track Stopped`)\r\n    }\r\n\r\n    onTrackAudioOutputChangedEvent = (deviceId) => {\r\n        console.log(`Track ${deviceId} audio output changed`)\r\n    }\r\n\r\n    updateTrack = (track, action = 'clear') => {\r\n        if (action === 'clear') {\r\n            if (track) {\r\n                // eslint-disable-next-line default-case\r\n                switch (track.type) {\r\n                    case 'audio':\r\n                    if (this.micRef.current) {\r\n                        track.track.detach(this.micRef.current)\r\n                    }\r\n                    break\r\n                    case 'video':\r\n                    if (this.videoRef.current) {\r\n                        track.track.detach(this.videoRef.current)\r\n                    }\r\n                    break\r\n                }\r\n            }\r\n        } else if (action === 'set') {\r\n            if (track) {\r\n            // eslint-disable-next-line default-case\r\n                switch (track.type) {\r\n                    case 'audio':\r\n                        if (this.micRef.current) {\r\n                            track.track.attach(this.micRef.current)\r\n                        }\r\n                    break\r\n                    case 'video':\r\n                        if (this.videoRef.current) {\r\n                            track.track.attach(this.videoRef.current)\r\n                        }\r\n                    break\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    render () {\r\n        \r\n        return <div class='remote_track'>\r\n            <div class='remote_track_controls'>\r\n                <span>???</span>\r\n            </div>\r\n            <div class='remote_track_body'>\r\n                <video autoPlay='1' ref={this.videoRef}/>\r\n            </div>\r\n            <div>\r\n                <audio autoPlay='1' ref={this.micRef} />\r\n            </div>\r\n        </div>\r\n\r\n    }\r\n}","import React from 'react';\nimport './App.css';\nimport { LocalTracks } from './LocalTracks'\nimport { LocalSpeaker } from './LocalSpeaker'\nimport _ from 'lodash'\nimport { RemoteTrack } from './RemoteTrack';\nimport { v4 as uuidv4 } from 'uuid'\n\nexport class App extends React.Component {\n  constructor (props) {\n    super(props)\n\n    this.state = {\n      serverURL: 'beta.meet.jit.si',\n      roomId: 'franktest',\n      selectedSpeakerDeviceId: '',\n      defaultMicId: '',\n      defaultVideoId: '',\n      defaultSpeakerId: '',\n      deviceList: [],\n      status: 'closed',\n      lastError: '',\n      remoteTrackIds: [],\n      loaded: false,\n      activeRoomId: null\n    }\n    window.telimed = {}\n    window.telimed.remoteTracks = []\n    window.telimed.activeConnection = null\n    window.telimed.activeRoom = null\n  }\n\n\n\n  componentDidMount () {\n    window.JitsiMeetJS.mediaDevices.enumerateDevices((devices) => {\n      let newDeviceList = []\n      for (let device of devices) {\n          // if (device.deviceId !== 'default' && device.deviceId !== 'communications') {\n              newDeviceList.push({ name: device.label, id: device.deviceId, type: device.kind })\n          // }\n      }\n      let micId = (_.find(newDeviceList, { type: 'audioinput' }) || {}).id || 'none'\n      let videoId = (_.find(newDeviceList, { type: 'videoinput' }) || {}).id || 'none'\n      let speakerId = (_.find(newDeviceList, { type: 'audiooutput' }) || {}).id || 'none'\n      this.setState({\n        deviceList: newDeviceList,\n        defaultMicId: micId,\n        defaultVideoId: videoId,\n        defaultSpeakerId: speakerId,\n        loaded: true\n      })\n    })\n  }\n\n  componentDidUpdate () {\n\n  }\n  \n  onSpeakerChanged = (newSpeaker) => {\n    this.setState({\n      selectedSpeakerDeviceId: newSpeaker.id\n    })\n  }\n\n  onServerChanged = (event) => {\n    this.setState({\n      serverURL: event.target.value\n    })\n  }\n\n  onRoomChanged = (event) => {\n    this.setState({\n      roomId: event.target.value\n    })\n  }\n\n  onRoomTrackAdded = (track) => {\n    if (track.isLocal() === true) {\n      return\n    }\n    let newTrackId = track.getId()\n    console.log(`Track Added: ${newTrackId}`)\n    let matchTrack = _.find(this.remoteTracks, { id: newTrackId })\n    if (matchTrack) {\n      return\n    }  \n    let trackInfo = {\n      id: newTrackId,\n      participantId: track.getParticipantId(),\n      type: track.getType(),\n      track: track\n    } \n    window.telimed.remoteTracks.push(trackInfo)\n    this.setState({\n      remoteTrackIds: _.map(window.telimed.remoteTracks, (rt) => { return { id: rt.id, participantId: rt.participantId } })\n    })\n  }\n\n  onRoomTrackRemoved = (track) => {\n    if (track.isLocal() === true) {\n      return\n    } \n    let trackId = track.getId()\n    window.telimed.remoteTracks = _.reject(window.telimed.remoteTracks, { id: trackId })\n    this.setState({\n      remoteTrackIds: _.map(window.telimed.remoteTracks, (rt) => { return { id: rt.id, participantId: rt.participantId } })\n    })\n  \n  }\n\n  onConnectionSuccess = () => {\n    const { roomId } = this.state\n    try {\n      window.telimed.activeRoom = window.telimed.activeConnection.initJitsiConference(roomId, {\n        openBridgeChannel: true\n      })\n      window.telimed.activeRoom.addEventListener(window.JitsiMeetJS.events.conference.TRACK_ADDED, this.onRoomTrackAdded)\n      window.telimed.activeRoom.addEventListener(window.JitsiMeetJS.events.conference.TRACK_REMOVED, this.onRoomTrackRemoved)\n      // this.activeRoom.on(\n      //     JitsiMeetJS.events.conference.CONFERENCE_JOINED,\n      //     onConferenceJoined);\n      //     this.activeRoom.on(JitsiMeetJS.events.conference.USER_JOINED, id => {\n      //     console.log('user join');\n      //     remoteTracks[id] = [];\n      // });\n      // this.activeRoom.on(JitsiMeetJS.events.conference.USER_LEFT, onUserLeft);\n      // this.activeRoom.on(JitsiMeetJS.events.conference.TRACK_MUTE_CHANGED, track => {\n      //     console.log(`${track.getType()} - ${track.isMuted()}`);\n      // });\n      // this.activeRoom.on(\n      //     JitsiMeetJS.events.conference.DISPLAY_NAME_CHANGED,\n      //     (userID, displayName) => console.log(`${userID} - ${displayName}`));\n      //     this.activeRoom.on(\n      //     JitsiMeetJS.events.conference.TRACK_AUDIO_LEVEL_CHANGED,\n      //     (userID, audioLevel) => console.log(`${userID} - ${audioLevel}`));\n      //     this.activeRoom.on(\n      //     JitsiMeetJS.events.conference.PHONE_NUMBER_CHANGED,\n      //     () => console.log(`${room.getPhoneNumber()} - ${room.getPhonePin()}`));\n      window.telimed.activeRoom.join()\n      this.setState({\n        status: 'open',\n        lastError: '',\n        activeRoomId: uuidv4()\n      })\n    } catch (error) {\n      this.setState({\n        status: 'closed',\n        lastError: error.message\n      })\n    }\n  }\n\n  onConnectionFailed = (a, b, c, d) => {\n    this.setState({\n      status: 'closed',\n      lastError: a,\n      activeRoomId: null\n    })\n  }\n\n  onConnectionDisconnect = () => {\n    window.telimed.activeConnection.removeEventListener(window.JitsiMeetJS.events.connection.CONNECTION_ESTABLISHED, this.onConnectionSuccess)\n    window.telimed.activeConnection.removeEventListener(window.JitsiMeetJS.events.connection.CONNECTION_FAILED, this.onConnectionFailed)\n    window.telimed.activeConnection.removeEventListener(window.JitsiMeetJS.events.connection.CONNECTION_DISCONNECTED, this.onConnectionDisconnect)\n    window.telimed.activeRoom.removeEventListener(window.JitsiMeetJS.events.conference.TRACK_ADDED, this.onRoomTrackAdded)\n    window.telimed.activeRoom.removeEventListener(window.JitsiMeetJS.events.conference.TRACK_REMOVED, this.onRoomTrackRemoved)\n  }\n\n  onConnect = () => {\n    const { roomId, serverURL } = this.state\n    this.setState({\n      status: 'Joining...'\n    })\n    window.telimed.activeConnection = new window.JitsiMeetJS.JitsiConnection(null, null, {\n      hosts: {\n        domain: serverURL,\n        muc: `conference.${serverURL}` // FIXME: use XEP-0030\n      },\n      serviceUrl:  `wss://${serverURL}/xmpp-websocket?room=${roomId}`,\n      clientNode: `https://${serverURL}`\n    })\n\n    window.telimed.activeConnection.addEventListener(window.JitsiMeetJS.events.connection.CONNECTION_ESTABLISHED, this.onConnectionSuccess)\n    window.telimed.activeConnection.addEventListener(window.JitsiMeetJS.events.connection.CONNECTION_FAILED, this.onConnectionFailed)\n    window.telimed.activeConnection.addEventListener(window.JitsiMeetJS.events.connection.CONNECTION_DISCONNECTED, this.onConnectionDisconnect)\n    window.telimed.activeConnection.connect()\n  }\n\n  onDisconnect = () => {\n    if (window.telimed.activeRoom) {\n      this.setState({\n        status: 'Leaving...'\n      })\n      try {  \n        window.telimed.activeRoom.leave().then(() => {\n          if (window.telimed.activeConnection) {\n            window.telimed.activeConnection.disconnect()\n          }\n          this.setState({\n            status: 'closed',\n            remoteTracks: [],\n            activeRoomId: null\n          })\n        })\n      } catch (error) {\n        this.setState({\n          status: 'closed',\n          lastError: error.message\n        })\n      }\n    }\n  }\n\n  renderRemoteTracks = (trackGroups = {}, selectedSpeakerDeviceId) => {\n    let ret = []\n\n    let participantIds = _.keys(trackGroups)\n\n    if (participantIds.length === 0) {\n      return null\n    }\n    for (let participantId of participantIds) {\n      ret.push(<div key={participantId} className=\"B_Body_Block\">\n        <RemoteTrack trackIds={trackGroups[participantId]} selectedSpeakerDeviceId={selectedSpeakerDeviceId} />\n      </div>)\n    }\n\n    return ret\n  }\n\n  render() {\n    const { selectedSpeakerDeviceId, serverURL, roomId, status, lastError, defaultMicId, defaultVideoId, defaultSpeakerId, deviceList, loaded = false, remoteTrackIds = [], activeRoomId } = this.state\n\n    if (loaded === false) {\n      return (\n        <div className='App'>\n          <div className='AppLoading'>\n            <h3>Loading...</h3>\n          </div>\n        </div>\n      )\n    }\n\n    let remoteTrackGroups = _.groupBy(remoteTrackIds, (rt) => { return rt.participantId })\n\n    return (\n      <div className=\"App\">\n        <div className=\"TL\">\n          <div>Server: <input readOnly={status !== 'closed'} type='text' onChange={(event) => { this.setState({ serverURL: event.target.value })}}  value={serverURL} /></div>\n          <div>Room: <input readOnly={status !== 'closed'} type='text' onChange={(event) => { this.setState({ roomId: event.target.value })}} value={roomId} /></div>\n          <div>\n            {status === 'closed'\n              ? <button onClick={this.onConnect}>\n                Connect\n              </button>\n              : status === 'open' \n                  ? <button onClick={this.onDisconnect}>\n                      Disconnect\n                    </button>\n                  : <button disabled={true} >\n                      {status}\n                    </button>\n            } \n          </div>\n          <div>{lastError}</div>\n        </div>\n        <div className=\"TR\">\n          <div className=\"TR_Header\">\n            <h3>Me</h3>\n            <LocalSpeaker deviceList={deviceList} key='LocalSpeaker' defaultSpeakerId={defaultSpeakerId} onSpeakerChanged={this.onSpeakerChanged} />\n          </div>\n          <div class='TR_Body'>\n            <div className=\"TR_Body_Block\">\n              <LocalTracks activeRoomId={activeRoomId} deviceList={deviceList} defaultMicId={defaultMicId} defaultVideoId={defaultVideoId} key='localTracks' />\n            </div>\n          </div>\n        </div>\n        <div className=\"B\">\n          <div className=\"B_Header\">\n            <h3>Them</h3>\n          </div>\n          <div className=\"B_Body\">\n            {this.renderRemoteTracks(remoteTrackGroups, selectedSpeakerDeviceId)}\n          </div>\n        </div>\n      </div>\n    )\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport { App } from './App';\n\nwindow.JitsiMeetJS.init()\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n"],"sourceRoot":""}